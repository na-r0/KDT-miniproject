ggtitle("Cancellation Status by Year") +
scale_fill_manual(values=c('pink','pink','pink')) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
geom_col() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Reservation Status by Year") +
geom_rect(stat="identity") + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect(stat="identity") + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_manual(values = c('#7BDDFC','#FFBE70')) +
geom_rect(stat="identity") + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
str(hotelDf)
# 월별 예약/취소 현황
ggplot(hotelDf, aes(x=arrival_date_month, y=is_canceled))+
geom_line()
# 월별 예약/취소 현황
ggplot(hotelDf, aes(x=arrival_date_month, y=!is_canceled))+
geom_line()
# 월별 예약/취소 현황
aggregate(hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
# 월별 예약/취소 현황
aggregate(!hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
month.canceled <- aggregate(hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
month.reserved <- aggregate(!hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
monthDf <- inner_join(month.reserved, month.canceled, by="Group.1")
monthDf
colnames(monthDf) <- c('month', 'reserved', 'canceled')
monthDf
ggplot(monthDf, aes(x=month, y=reserved))+
geom_line()
y
y
ggplot(monthDf, aes(x=month, y=reserved))+
geom_line()
ggplot(hotelDf, aes(x=arrival_date_month, fill=is_canceled))+
geom_line()
ggplot(hotelDf, aes(x=arrival_date_month, y=is_canceled))+
geom_line()
ggplot(hotelDf, aes(x=reservation_date_month, y=is_canceled))+
geom_line()
ggplot(hotelDf, aes(x=reservation_status_date, y=is_canceled))+
geom_line()
ggplot(hotelDf, aes(x=reservation_status_date, fill=is_canceled))+
geom_line()
ggplot(hotelDf, aes(x=reservation_status_date, y=!is_canceled))+
geom_line()
month.canceled <- aggregate(hotelDf$is_canceled, by=list(hotelDf$reservation_status_date), FUN=sum)
month.canceled
month.reserved <- aggregate(!hotelDf$is_canceled, by=list(hotelDf$reservation_status_date), FUN=sum)
monthDf <- inner_join(month.reserved, month.canceled, by="Group.1")
colnames(monthDf) <- c('month', 'reserved', 'canceled')
ggplot(monthDf, aes(x=month, y=reserved))+
geom_line()
ggplot(monthDf, aes(x=month, y=reserved))
ggplot(monthDf, aes(x=month, y=reserved)) + geom_bar()
ggplot(monthDf, aes(x=month, y=reserved)) + geom_bar(position='dodge', stat = 'identity') +
ggplot(monthDf, aes(x=month, y=reserved)) + geom_bar(position='dodge', stat = 'identity')
ggplot(monthDf, aes(x=month, fill=reserved)) + geom_bar(position='dodge', stat = 'identity')
ggplot(monthDf, aes(x=month, y=reserved))
View(year.reserved)
xValue <- 1:10
yValue <- cumsum(rnorm(10))
data <- data.frame(xValue,yValue)
data
# Plot
ggplot(data, aes(x=xValue, y=yValue)) +
geom_line()
monthDf
ggplot(monthDf, aes(x=month, y=reserved))
month.canceled <- aggregate(hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
month.reserved <- aggregate(!hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
month.canceled
monthDf <- inner_join(month.reserved, month.canceled, by="Group.1")
colnames(monthDf) <- c('month', 'reserved', 'canceled')
monthDf
ggplot(monthDf, aes(x=month, y=reserved)) + geom_line()
xValue <- monthDf$month
yValue <- cumsum(rnorm(monthDf$reserved))
data <- data.frame(xValue, yValue)
data
ggplot(data, aes(x=xValue, y=yValue)) + geom_line()
monthDf$month <- c(4,8,12,2,1,6,7,3,5,11,10,11)
monthDf
xValue <- monthDf$month
yValue <- cumsum(rnorm(monthDf$reserved))
data <- data.frame(xValue, yValue)
data
ggplot(data, aes(x=xValue, y=yValue)) + geom_line()
ggplot(monthDf, aes(x=month, y=reserved)) + geom_line()
monthDf <- inner_join(month.reserved, month.canceled, by="Group.1")
colnames(monthDf) <- c('month', 'reserved', 'canceled')
monthDf
monthDf$month <- c(4,8,12,2,1,6,7,3,5,11,10,9)
monthDf
# Plot
ggplot(data, aes(x=xValue, y=yValue)) +
geom_line()
sort(monthDf,by = list(month))
sort(monthDf$month)
monthDf$month <- sort(monthDf$month)
monthDf
month.canceled <- aggregate(hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
month.reserved <- aggregate(!hotelDf$is_canceled, by=list(hotelDf$arrival_date_month), FUN=sum)
monthDf <- inner_join(month.reserved, month.canceled, by="Group.1")
colnames(monthDf) <- c('month', 'reserved', 'canceled')
monthDf$month <- c(4,8,12,2,1,6,7,3,5,11,10,9)
monthDf
monthDf$month[order(monthDf$month)]
monthDf
monthDf[order(monthDf$month),]
monthDf <- monthDf[order(monthDf$month),]
ggplot(monthDf, aes(x=month, y=reserved)) + geom_line()
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",size=1)+
geom_line(aes(month,canceled),col="cyan4",size=1)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5)
library(dplyr)
library(reshape2)
library(reshape2)
library(reshape2)
a <- select(monthDf,c(month,reserved,canceled))
b <- melt(a,id.vars = 'month')
ggplot(b, aes(month, value))+
geom_line(aes(col=variable))
ggplot(b, aes(month, value))+
geom_erea(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
coord_cartesian(xlim = c(4.5,5.5))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
coord_cartesian(xlim = c(1,12))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
coord_cartesian(xlim = c('1월'))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_line(size = 1, color = "#b30000") +
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
a
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5) +
geom_area(aes(col=month, fill=month), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(xintercept = max(value)))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(xintercept = max(variable)))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(xintercept = max(value)))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(xintercept = max(value)), linetype='dash')
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(xintercept = max(value)), linetype='dashed')
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity()) +
geom_vline(aes(yintercept = max(value)), linetype='dashed')
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA", high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
?scale_fill_gradient
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_colour_gradient(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
?scale_fill_gradient
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_colour_gradient2(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA",  high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA", meadian='#9FE8FA', high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
scale_fill_gradient(low = "#9FE8FA",high = "#26BAEE" ) +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
theme(legend.position = 'none', color = Group.1,
plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1,), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
'  scale_fill_gradient(low = "#9FE8FA",high = "#26BAEE" ) +'
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
'  scale_fill_gradient(low = "#9FE8FA",high = "#26BAEE" ) +'
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_brewer(palette=3) +
scale_color_brewer(palette=3) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
'  scale_fill_gradient(low = "#9FE8FA",high = "#26BAEE" ) +'
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_brewer(palette=3) +
scale_color_brewer(palette=3) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
'  scale_fill_gradient(low = "#9FE8FA",high = "#26BAEE" ) +'
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_brewer(palette=3) +
scale_color_brewer(palette=3) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = T) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_brewer(palette=3) +
scale_color_brewer(palette=3) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = T) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
scale_fill_brewer(palette=3) +
scale_color_brewer(palette=3) +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label, color = Group.1), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_point() +
geom_segment( aes(x=month, xend=month, y=0, yend=reserved))
p1 <- ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
p2 <- ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
grid.arrange(arrangeGrob(p1, p2, ncol=2), nrow = 1)
library(gridExtra)
grid.arrange(arrangeGrob(p1, p2, ncol=2), nrow = 1)
grid.arrange(arrangeGrob(p2, p1, ncol=2), nrow = 1)
p2 <- ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
grid.arrange(arrangeGrob(p2, p1, ncol=2), nrow = 1)
p1 <- ggplot(year.canceled, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("   Cancellation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none', plot.title=element_text(face='bold'))
p2 <- ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("   Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
grid.arrange(arrangeGrob(p2, p1, ncol=2), nrow = 1)
p2 <- ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
grid.arrange(arrangeGrob(p2, p1, ncol=2), nrow = 1)
p2 <- ggplot(year.reserved, aes(ymax=ymax,ymin=ymin,xmax=4,xmin=3, fill=Group.1))+
ggtitle("           Reservation Status by Year") +
geom_rect() + geom_text(x=2.3, aes(y=labelPosition, label=label), size =4)+
coord_polar(theta='y') +
scale_fill_viridis(discrete = F) +
xlim(c(1,4)) + theme_void() +
theme(legend.position = 'none',plot.title=element_text(face='bold'))
grid.arrange(arrangeGrob(p2, p1, ncol=2), nrow = 1)
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_point() +
geom_segment( aes(x=month, xend=month, y=0, yend=reserved))
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5) +
geom_area(position = 'dodge',alpha = 0.7)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5) +
geom_area(position = 'dodge',alpha = 0.7,col="orangered")
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_area(position = 'dodge',alpha = 0.7) +
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5) +
geom_area(position = 'dodge',alpha = 0.7)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5) +
geom_area(position = 'dodge',alpha = 0.7)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_line(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_line(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5)
ggplot(b, aes(month, value))+
geom_area(aes(col=variable, fill=variable), alpha=0.5,
position=position_identity())
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_area(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.5)+
geom_area(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.5)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_area(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.7)+
geom_area(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.7)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_area(aes(month,reserved),col="orangered",fill="orangered",size=1,alpha=0.3)+
geom_area(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.3)
ggplot(monthDf, aes(x=month, y=reserved)) +
geom_area(aes(month,reserved+canceled),col="orangered",fill="orangered",size=1,alpha=0.3)+
geom_area(aes(month,canceled),col="cyan4",fill="cyan4",size=1,alpha=0.3)
ggplot(hotelnameDf, aes(x=hotel, y=count, fill=status)) +
ggtitle("Reservation/Cancellation Status by Hotel") +
geom_bar(position='dodge', stat = 'identity') +
scale_fill_manual(values = c('#7BDDFC','#FFBE70')) +
geom_text(aes(label = sprintf('%d',count)),
position = position_dodge(0.9),
hjust = 0.5, vjust = -0.5) +
scale_y_discrete() +
coord_cartesian(ylim = c(0,50000)) +
theme(panel.background = element_blank(),
text = element_text(face='bold'),
plot.title = element_text(face='bold'),
axis.title.x = element_text(size=15, face='bold'),
axis.text.x = element_text(size=12),
axis.title.y = element_text(size=15, face='bold'),
legend.position = 'top')
ggplot(familyDf, aes(Group.1, x)) +
geom_violin(aes(fill=Group.1), alpha=0.5, color=NA) +
geom_jitter(aes(color=Group.1), size=2)
