<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="신나령">

<title>project8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="project8_files/libs/clipboard/clipboard.min.js"></script>
<script src="project8_files/libs/quarto-html/quarto.js"></script>
<script src="project8_files/libs/quarto-html/popper.min.js"></script>
<script src="project8_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="project8_files/libs/quarto-html/anchor.min.js"></script>
<link href="project8_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="project8_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="project8_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="project8_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="project8_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">project8</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>신나령 </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="팀-2조" class="level4">
<h4 class="anchored" data-anchor-id="팀-2조">팀: 2조</h4>
</section>
<section id="주제-화학-성분에-따른-레드-와인-품질-예측-분석" class="level4">
<h4 class="anchored" data-anchor-id="주제-화학-성분에-따른-레드-와인-품질-예측-분석">주제: 화학 성분에 따른 레드 와인 품질 예측 분석</h4>
</section>
<section id="방식-이항로지스틱회귀분석" class="level4">
<h4 class="anchored" data-anchor-id="방식-이항로지스틱회귀분석">방식: 이항로지스틱회귀분석</h4>
<section id="출처-httpswww.kaggle.comdatasetsucimlred-wine-quality-cortez-et-al-2009" class="level5">
<h5 class="anchored" data-anchor-id="출처-httpswww.kaggle.comdatasetsucimlred-wine-quality-cortez-et-al-2009">출처: https://www.kaggle.com/datasets/uciml/red-wine-quality-cortez-et-al-2009</h5>
</section>
</section>
<section id="데이터-불러오기" class="level3">
<h3 class="anchored" data-anchor-id="데이터-불러오기">데이터 불러오기</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'./winequality-red.csv'</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1599 obs. of  12 variables:
 $ fixed.acidity       : num  7.4 7.8 7.8 11.2 7.4 7.4 7.9 7.3 7.8 7.5 ...
 $ volatile.acidity    : num  0.7 0.88 0.76 0.28 0.7 0.66 0.6 0.65 0.58 0.5 ...
 $ citric.acid         : num  0 0 0.04 0.56 0 0 0.06 0 0.02 0.36 ...
 $ residual.sugar      : num  1.9 2.6 2.3 1.9 1.9 1.8 1.6 1.2 2 6.1 ...
 $ chlorides           : num  0.076 0.098 0.092 0.075 0.076 0.075 0.069 0.065 0.073 0.071 ...
 $ free.sulfur.dioxide : num  11 25 15 17 11 13 15 15 9 17 ...
 $ total.sulfur.dioxide: num  34 67 54 60 34 40 59 21 18 102 ...
 $ density             : num  0.998 0.997 0.997 0.998 0.998 ...
 $ pH                  : num  3.51 3.2 3.26 3.16 3.51 3.51 3.3 3.39 3.36 3.35 ...
 $ sulphates           : num  0.56 0.68 0.65 0.58 0.56 0.56 0.46 0.47 0.57 0.8 ...
 $ alcohol             : num  9.4 9.8 9.8 9.8 9.4 9.4 9.4 10 9.5 10.5 ...
 $ quality             : int  5 5 5 6 5 5 5 7 7 5 ...</code></pre>
</div>
</div>
</section>
<section id="결측치-확인" class="level3">
<h3 class="anchored" data-anchor-id="결측치-확인">결측치 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="데이터-이상치-확인" class="level3">
<h3 class="anchored" data-anchor-id="데이터-이상치-확인">데이터 이상치 확인</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 처리 전</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1599</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>outlier <span class="ot">&lt;-</span> <span class="fu">boxplot.stats</span>(df<span class="sc">$</span>total.sulfur.dioxide)<span class="sc">$</span>out</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df[df<span class="sc">$</span>total.sulfur.dioxide <span class="sc">%in%</span> outlier,] <span class="ot">&lt;-</span> <span class="cn">NA</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df) <span class="co"># 결측치 삭제</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 처리한 후</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1544</code></pre>
</div>
</div>
</section>
<section id="품질별-레드와인-수" class="level2">
<h2 class="anchored" data-anchor-id="품질별-레드와인-수">1. 품질별 레드와인 수</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(df<span class="sc">$</span>quality),<span class="at">col=</span><span class="st">'#880000'</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">'Number of red wines by quality'</span>,<span class="at">ylab=</span><span class="st">'count'</span>,<span class="at">xlab=</span><span class="st">'quality'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="중간-등급이-많고-품질이-나쁘거나-좋은-건-소수" class="level5">
<h5 class="anchored" data-anchor-id="중간-등급이-많고-품질이-나쁘거나-좋은-건-소수">· 중간 등급이 많고, 품질이 나쁘거나 좋은 건 소수</h5>
</section>
</section>
<section id="컬럼별-상관관계" class="level2">
<h2 class="anchored" data-anchor-id="컬럼별-상관관계">2. 컬럼별 상관관계</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 파랑-양, 빨강-음, 색이 진할수록 강함</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrgram)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrgram</span>(df,<span class="at">order=</span><span class="cn">TRUE</span>,<span class="at">lower.panel =</span> panel.shade,<span class="at">upper.panel =</span> panel.cor,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">text.panel =</span> panel.txt, <span class="at">main=</span><span class="st">"reds wine corrgram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="품질과-상관관계가-있는-건-알콜0.47과-휘발성-산-0.39" class="level5">
<h5 class="anchored" data-anchor-id="품질과-상관관계가-있는-건-알콜0.47과-휘발성-산-0.39">· 품질과 상관관계가 있는 건 알콜(0.47)과 휘발성 산(-0.39)</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(df<span class="sc">$</span>alcohol<span class="sc">~</span>df<span class="sc">$</span>quality,<span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">6</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Alcohol of red wines by quality'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">'quality'</span>, <span class="at">ylab =</span> <span class="st">'alcohol'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(df<span class="sc">$</span>volatile.acidity<span class="sc">~</span>df<span class="sc">$</span>quality,<span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">6</span>),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">'Volatile acidity of red wines by quality'</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">'quality'</span>, <span class="at">ylab =</span> <span class="st">'volatile acidity'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="알콜은-양의-상관-휘발성-산은-음의-상관" class="level5">
<h5 class="anchored" data-anchor-id="알콜은-양의-상관-휘발성-산은-음의-상관">· 알콜은 양의 상관, 휘발성 산은 음의 상관</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>quality,df<span class="sc">$</span>alcohol)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  df$quality and df$alcohol
t = 20.717, df = 1542, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 0.4266712 0.5047625
sample estimates:
      cor 
0.4666258 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(df<span class="sc">$</span>quality,df<span class="sc">$</span>volatile.acidity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's product-moment correlation

data:  df$quality and df$volatile.acidity
t = -16.625, df = 1542, p-value &lt; 2.2e-16
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
 -0.4313612 -0.3467205
sample estimates:
       cor 
-0.3898639 </code></pre>
</div>
</div>
</section>
<section id="cor.test-결과-두-변수-다-유의확률이-0.05-미만" class="level5">
<h5 class="anchored" data-anchor-id="cor.test-결과-두-변수-다-유의확률이-0.05-미만">· cor.test 결과 두 변수 다 유의확률이 0.05 미만</h5>
</section>
</section>
<section id="이항로지스틱회귀분석" class="level2">
<h2 class="anchored" data-anchor-id="이항로지스틱회귀분석">3. 이항로지스틱회귀분석</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과변수는 이분형 범주여야 해서 품질을 7이상이면 yes, 미만이면 no로 2개의 등급을 따로 만들어 줌</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>is.quality <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(df<span class="sc">$</span>quality<span class="sc">&gt;=</span><span class="dv">7</span>,<span class="st">'Yes'</span>,<span class="st">'No'</span>))</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(df<span class="sc">$</span>is.quality),<span class="at">col=</span><span class="st">'#880000'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="품질이-좋은-게-상대적으로-적음" class="level5">
<h5 class="anchored" data-anchor-id="품질이-좋은-게-상대적으로-적음">· 품질이 좋은 게 상대적으로 적음</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[,<span class="sc">-</span><span class="dv">12</span>] <span class="co"># 원래 있던 quality 변수 삭제</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.quality <span class="sc">~</span> .,<span class="at">data=</span>df,<span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">'logit'</span>))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = is.quality ~ ., family = binomial(link = "logit"), 
    data = df)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-2.8226  -0.4312  -0.2253  -0.1139   2.9726  

Coefficients:
                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)           1.730e+02  1.108e+02   1.562 0.118216    
fixed.acidity         1.990e-01  1.276e-01   1.559 0.119004    
volatile.acidity     -2.588e+00  7.967e-01  -3.248 0.001161 ** 
citric.acid           2.163e-01  8.553e-01   0.253 0.800348    
residual.sugar        1.973e-01  8.039e-02   2.455 0.014105 *  
chlorides            -9.316e+00  3.166e+00  -2.942 0.003259 ** 
free.sulfur.dioxide   1.920e-02  1.338e-02   1.434 0.151481    
total.sulfur.dioxide -2.339e-02  6.174e-03  -3.789 0.000151 ***
density              -1.860e+02  1.131e+02  -1.644 0.100170    
pH                   -3.552e-01  1.045e+00  -0.340 0.733959    
sulphates             4.586e+00  6.246e-01   7.342 2.11e-13 ***
alcohol               8.000e-01  1.354e-01   5.910 3.42e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1246.3  on 1543  degrees of freedom
Residual deviance:  850.3  on 1532  degrees of freedom
AIC: 874.3

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="volatile.acidity-residual.sugar-chlorides-total.sulfur.dioxide-sulphates-alcohol-휘발성-산-잔여당-염화율-전체-이산화황-황산염-알콜-변수들의-유의확률이-0.05보다-작음" class="level5">
<h5 class="anchored" data-anchor-id="volatile.acidity-residual.sugar-chlorides-total.sulfur.dioxide-sulphates-alcohol-휘발성-산-잔여당-염화율-전체-이산화황-황산염-알콜-변수들의-유의확률이-0.05보다-작음">· volatile.acidity, residual.sugar, chlorides, total.sulfur.dioxide, sulphates, alcohol (휘발성 산, 잔여당, 염화율, 전체 이산화황, 황산염, 알콜) 변수들의 유의확률이 0.05보다 작음</h5>
</section>
<section id="휘발성-산-염화율-전체-이산화황-변수들은-낮아질수록-품질이-좋아지고-잔여당-황산염-알콜변수들은-증가할수록-품질이-좋아짐" class="level5">
<h5 class="anchored" data-anchor-id="휘발성-산-염화율-전체-이산화황-변수들은-낮아질수록-품질이-좋아지고-잔여당-황산염-알콜변수들은-증가할수록-품질이-좋아짐">· 휘발성 산, 염화율, 전체 이산화황 변수들은 낮아질수록 품질이 좋아지고, 잔여당, 황산염, 알콜변수들은 증가할수록 품질이 좋아짐</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="fu">cbind</span>(<span class="at">OR=</span><span class="fu">coef</span>(model),<span class="fu">confint</span>(model)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Waiting for profiling to be done...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>odds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               OR         2.5 %        97.5 %
(Intercept)          1.423746e+75  9.018865e-20 5.473160e+169
fixed.acidity        1.220167e+00  9.496606e-01  1.567213e+00
volatile.acidity     7.518558e-02  1.531878e-02  3.479086e-01
citric.acid          1.241479e+00  2.300852e-01  6.590081e+00
residual.sugar       1.218138e+00  1.031132e+00  1.417267e+00
chlorides            8.999462e-05  8.498024e-08  2.395162e-02
free.sulfur.dioxide  1.019383e+00  9.930265e-01  1.046653e+00
total.sulfur.dioxide 9.768789e-01  9.646517e-01  9.883514e-01
density              1.728781e-81 4.494407e-178  2.711668e+15
pH                   7.010608e-01  8.867010e-02  5.347147e+00
sulphates            9.808603e+01  2.892910e+01  3.370218e+02
alcohol              2.225465e+00  1.711246e+00  2.911488e+00</code></pre>
</div>
</div>
</section>
<section id="오즈비는-황산염-알콜이-가장-큼" class="level5">
<h5 class="anchored" data-anchor-id="오즈비는-황산염-알콜이-가장-큼">· 오즈비는 황산염, 알콜이 가장 큼</h5>
</section>
<section id="황산염-값이-1-증가하면-품질이-높아질-확률이-약-98배-증가하고-알콜은-1증가하면-품질이-높아질-확률이-약-2.25배-증가" class="level5">
<h5 class="anchored" data-anchor-id="황산염-값이-1-증가하면-품질이-높아질-확률이-약-98배-증가하고-알콜은-1증가하면-품질이-높아질-확률이-약-2.25배-증가">· 황산염 값이 1 증가하면 품질이 높아질 확률이 약 98배 증가하고, 알콜은 1증가하면 품질이 높아질 확률이 약 2.25배 증가</h5>
</section>
</section>
<section id="원래-분류-모델-roc-그래프" class="level2">
<h2 class="anchored" data-anchor-id="원래-분류-모델-roc-그래프">3. 원래 분류 모델 ROC 그래프</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 독립변수 다 포함</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(is.quality<span class="sc">~</span> model<span class="sc">$</span>fitted.values,<span class="at">data=</span>df,<span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'ROC CURVE'</span>,<span class="at">col=</span><span class="st">'tomato'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.formula(formula = is.quality ~ model$fitted.values, data = df,     plot = TRUE, main = "ROC CURVE", col = "tomato")

Data: model$fitted.values in 1329 controls (is.quality No) &lt; 215 cases (is.quality Yes).
Area under the curve: 0.8827</code></pre>
</div>
</div>
<section id="모든-독립변수-다-넣었을-때-auc-값이-0.8827" class="level5">
<h5 class="anchored" data-anchor-id="모든-독립변수-다-넣었을-때-auc-값이-0.8827">· 모든 독립변수 다 넣었을 때 AUC 값이 0.8827</h5>
</section>
</section>
<section id="새로운-분류-모델-roc-그래프" class="level2">
<h2 class="anchored" data-anchor-id="새로운-분류-모델-roc-그래프">4-(1). 새로운 분류 모델 ROC 그래프</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 유의한 변수들만 넣어서 다시 모델 만듦</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>re.model <span class="ot">&lt;-</span> <span class="fu">glm</span>(is.quality <span class="sc">~</span> volatile.acidity<span class="sc">+</span>residual.sugar<span class="sc">+</span>chlorides <span class="sc">+</span>total.sulfur.dioxide<span class="sc">+</span>sulphates<span class="sc">+</span>alcohol,<span class="at">data=</span>df,<span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link=</span><span class="st">'logit'</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">roc</span>(is.quality<span class="sc">~</span> re.model<span class="sc">$</span>fitted.values,<span class="at">data=</span>df,<span class="at">plot=</span><span class="cn">TRUE</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">'ROC CURVE'</span>,<span class="at">col=</span><span class="st">'tomato'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = No, case = Yes</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.formula(formula = is.quality ~ re.model$fitted.values, data = df,     plot = TRUE, main = "ROC CURVE", col = "tomato")

Data: re.model$fitted.values in 1329 controls (is.quality No) &lt; 215 cases (is.quality Yes).
Area under the curve: 0.8775</code></pre>
</div>
</div>
<section id="위에서-확인한-유의확률이-높은-독립변수들휘발성-산-잔여당-염화율-전체-이산화황-황산염-알콜만-넣었을-때-auc-값이-0.8775" class="level5">
<h5 class="anchored" data-anchor-id="위에서-확인한-유의확률이-높은-독립변수들휘발성-산-잔여당-염화율-전체-이산화황-황산염-알콜만-넣었을-때-auc-값이-0.8775">· 위에서 확인한 유의확률이 높은 독립변수들(휘발성 산, 잔여당, 염화율, 전체 이산화황, 황산염, 알콜)만 넣었을 때 AUC 값이 0.8775</h5>
</section>
</section>
<section id="혼동행렬" class="level2">
<h2 class="anchored" data-anchor-id="혼동행렬">4-(2). 혼동행렬</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 결과변수는 일정 기준값인 0.5보다 크면 사건이 발생한 것으로 간주</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>pred <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(re.model<span class="sc">$</span>fitted.values <span class="sc">&gt;</span> <span class="fl">0.5</span>,<span class="st">'Yes'</span>,<span class="st">'No'</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df<span class="sc">$</span>is.quality,df<span class="sc">$</span>pred)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>tab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     
        No  Yes
  No  1289   40
  Yes  144   71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span>pred<span class="sc">+</span>is.quality,<span class="at">data=</span>df,<span class="at">color =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="st">'Confusion matrix'</span>,<span class="at">ylab=</span><span class="st">'실제'</span>,<span class="at">xlab=</span><span class="st">'예측'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="project8_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 분류모델의 성능평가지표</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 정확도 계산</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>TP <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>TN <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>FP <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>FN <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>accurancy <span class="ot">&lt;-</span> (TP<span class="sc">+</span>TN)<span class="sc">/</span>(TP<span class="sc">+</span>TN<span class="sc">+</span>FP<span class="sc">+</span>FN)</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>accurancy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.880829</code></pre>
</div>
</div>
<section id="정확도참과-거짓을-정확히-맞힌-비율-높음" class="level5">
<h5 class="anchored" data-anchor-id="정확도참과-거짓을-정확히-맞힌-비율-높음">· 정확도(참과 거짓을 정확히 맞힌 비율) 높음</h5>
</section>
<section id="결론-새로운-분류-모델의-auc-값이-원래-분류-모델의-auc-값과-별다른-차이가-없고-정확도가-0.88-정도로-높은-것으로-보아-회귀모델이-적합하다고-볼-수-있음" class="level5">
<h5 class="anchored" data-anchor-id="결론-새로운-분류-모델의-auc-값이-원래-분류-모델의-auc-값과-별다른-차이가-없고-정확도가-0.88-정도로-높은-것으로-보아-회귀모델이-적합하다고-볼-수-있음"><strong>[결론]</strong> 새로운 분류 모델의 AUC 값이 원래 분류 모델의 AUC 값과 별다른 차이가 없고, 정확도가 0.88 정도로 높은 것으로 보아 회귀모델이 적합하다고 볼 수 있음</h5>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>